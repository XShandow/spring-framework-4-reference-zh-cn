### 7.16.2 Glue code and the evil singleton

It is best to write most application code in a dependency-injection \(DI\) style, where that code is served out of a Spring IoC container, has its own dependencies supplied by the container when it is created, and is completely unaware of the container. However, for the small glue layers of code that are sometimes needed to tie other code together, you sometimes need a singleton \(or quasi-singleton\) style access to a Spring IoC container. For example, third-party code may try to construct new objects directly \(`Class.forName()`style\), without the ability to get these objects out of a Spring IoC container.If the object constructed by the third-party code is a small stub or proxy, which then uses a singleton style access to a Spring IoC container to get a real object to delegate to, then inversion of control has still been achieved for the majority of the code \(the object coming out of the container\). Thus most code is still unaware of the container or how it is accessed, and remains decoupled from other code, with all ensuing benefits. EJBs may also use this stub/proxy approach to delegate to a plain Java implementation object, retrieved from a Spring IoC container. While the Spring IoC container itself ideally does not have to be a singleton, it may be unrealistic in terms of memory usage or initialization times \(when using beans in the Spring IoC container such as a Hibernate`SessionFactory`\) for each bean to use its own, non-singleton Spring IoC container.

Looking up the application context in a service locator style is sometimes the only option for accessing shared Spring-managed components, such as in an EJB 2.1 environment, or when you want to share a single ApplicationContext as a parent to WebApplicationContexts across WAR files. In this case you should look into using the utility class[`ContextSingletonBeanFactoryLocator`](http://docs.spring.io/spring-framework/docs/4.3.11.RELEASE/javadoc-api/org/springframework/context/access/ContextSingletonBeanFactoryLocator.html)locator that is described in this[Spring team blog entry](https://spring.io/blog/2007/06/11/using-a-shared-parent-application-context-in-a-multi-war-spring-application/).

  


---

[\[1\]](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#d5e1827)See[Background](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#background-ioc)

[\[2\]](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#d5e2672)See[Section 7.4.1, “Dependency Injection”](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#beans-factory-collaborators)

