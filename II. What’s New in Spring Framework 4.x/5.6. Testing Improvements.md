## 5.6 Testing Improvements

* JUnit-based integration tests can now be executed with JUnit rules instead of the`SpringJUnit4ClassRunner`. This allows Spring-based integration tests to be run with alternative runners like JUnit’s`Parameterized`or third-party runners such as the`MockitoJUnitRunner`.
* 基于 JUnit 集成测试现在可以执行 JUnit 规则而不是SpringJUnit4ClassRunner。这允许基于 spring 的集成测试与运行JUnit 的 Parameterized 或第三方 运行器 MockitoJUnitRunner 等。详见 Spring JUnit 规则

  * See[the section called “Spring JUnit 4 Rules”](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#testcontext-junit4-rules)for details.

* The Spring MVC Test framework now provides first-class support for HtmlUnit, including integration with Selenium’s WebDriver, allowing for page-based web application testing without the need to deploy to a Servlet container.
* Spring MVC Test 框架，现在支持第一类 HtmlUnit，包括集成 Selenium’s WebDriver,允许基于页面的 Web 应用测试而无需部署到 Servlet 容器。详见 14.6.2, “HtmlUnit 集成”

  * See[Section 15.6.2, “HtmlUnit Integration”](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#spring-mvc-test-server-htmlunit)for details.

* `AopTestUtils`is a new testing utility that allows developers to obtain a reference to the underlying target object hidden behind one or more Spring proxies.
* AopTestUtils 是一个新的测试工具，允许开发者获得潜在的目标对象的引用隐藏在一个或多个 Spring 代理。详见 13.2.1, “常见测试工具”

  * See [Section 14.2.1, “General testing utilities”](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#unit-testing-utilities)for details.

* `ReflectionTestUtils`now supports setting and getting`static`fields, including constants.
* ReflectionTestUtils 现在支持 setting 和 getting static 字段,包括常量
* The original ordering of bean definition profiles declared via`@ActiveProfiles`is now retained in order to support use cases such as Spring Boot’s`ConfigFileApplicationListener`which loads configuration files based on the names of active profiles.
* `@DirtiesContext`supports new`BEFORE_METHOD`,`BEFORE_CLASS`, and`BEFORE_EACH_TEST_METHOD`modes for closing the`ApplicationContext`_before _a test — for example, if some rogue \(i.e., yet to be determined\) test within a large test suite has corrupted the original configuration for the`ApplicationContext`.
* `@Commit`is a new annotation that may be used as a direct replacement for`@Rollback(false)`.
* `@Rollback`may now be used to configure class-level_default rollback_semantics.

  * Consequently,`@TransactionConfiguration`is now deprecated and will be removed in a subsequent release.

* `@Sql`now supports execution of_inlined SQL statements_via a new`statements`attribute.
* The`ContextCache`that is used for caching`ApplicationContext`s between tests is now a public API with a default implementation that can be replaced for custom caching needs.
* `DefaultTestContext`,`DefaultBootstrapContext`, and`DefaultCacheAwareContextLoaderDelegate`are now public classes in the`support`subpackage, allowing for custom extensions.
* `TestContextBootstrapper`s are now responsible for building the`TestContext`.
* In the Spring MVC Test framework,`MvcResult`details can now be logged at`DEBUG`level or written to a custom`OutputStream`or`Writer`. See the new`log()`,`print(OutputStream)`, and`print(Writer)`methods in`MockMvcResultHandlers`for details.
* The JDBC XML namespace supports a new`database-name`attribute in`<jdbc:embedded-database>`, allowing developers to set unique names for embedded databases –- for example, via a SpEL expression or a property placeholder that is influenced by the current active bean definition profiles.
* Embedded databases can now be automatically assigned a unique name, allowing common test database configuration to be reused in different`ApplicationContext`s within a test suite.

  * See [Section 19.8.6, “Generating unique names for embedded databases”](https://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#jdbc-embedded-database-unique-names)for details.

* `MockHttpServletRequest`and`MockHttpServletResponse`now provide better support for date header formatting via the`getDateHeader`and`setDateHeader`methods.



